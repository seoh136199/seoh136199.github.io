<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><meta name="day-prompt" content="days ago" /><meta name="hour-prompt" content="hours ago" /><meta name="minute-prompt" content="minutes ago" /><meta name="justnow-prompt" content="just now" /><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="[Pancht] 요트 다이스 최적 선택 알고리즘을 구현한 방법" /><meta property="og:locale" content="en" /><meta name="description" content="• 서론 •" /><meta property="og:description" content="• 서론 •" /><link rel="canonical" href="https://seoh136199.github.io/posts/yacht-dice-optimal-selection-algorithm/" /><meta property="og:url" content="https://seoh136199.github.io/posts/yacht-dice-optimal-selection-algorithm/" /><meta property="og:site_name" content="Seohyun’s DEVlog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-12-31T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[Pancht] 요트 다이스 최적 선택 알고리즘을 구현한 방법" /><meta name="twitter:site" content="@fried_ctex" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-12-31T00:00:00+09:00","datePublished":"2024-12-31T00:00:00+09:00","description":"• 서론 •","headline":"[Pancht] 요트 다이스 최적 선택 알고리즘을 구현한 방법","mainEntityOfPage":{"@type":"WebPage","@id":"https://seoh136199.github.io/posts/yacht-dice-optimal-selection-algorithm/"},"url":"https://seoh136199.github.io/posts/yacht-dice-optimal-selection-algorithm/"}</script><title>[Pancht] 요트 다이스 최적 선택 알고리즘을 구현한 방법 | Seohyun's DEVlog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Seohyun's DEVlog"><meta name="application-name" content="Seohyun's DEVlog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://fonts.gstatic.com" /><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials" /><link rel="dns-prefetch" href="https://www.google-analytics.com" /><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://www.googletagmanager.com" /><link rel="preconnect" href="https://cdn.jsdelivr.net" /><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" /><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/ProfileImage.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Seohyun's DEVlog</a></div><div class="site-subtitle font-italic"></div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/seoh136199" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/fried_ctex" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['seoh136199','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[Pancht] 요트 다이스 최적 선택 알고리즘을 구현한 방법</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[Pancht] 요트 다이스 최적 선택 알고리즘을 구현한 방법</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Seohyun Yang </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Dec 31, 2024, 12:00 AM +0900" >Dec 31, 2024<i class="unloaded">2024-12-31T00:00:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Tue, Dec 31, 2024, 12:00 AM +0000" >Dec 31, 2024<i class="unloaded">2024-12-31T00:00:00+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="7965 words">44 min read</span></div></div><div class="post-content"><h1 id="-서론-">• 서론 •</h1><h2 id="왜-하게-되었는가">왜 하게 되었는가</h2><p>요트 다이스의 룰을 차용한 Pancht라는 게임에 AI 대전 모드를 넣게 되었다. 이 AI는 숙련된 플레이어의 실력에 준하는, 또는 그 이상의 실력을 갖춰야 고티어 플레이어와 유의미한 대결이 가능할 것이다.<br /> 숙련된 플레이어의 의사 결정을 모방해서 로직을 직접 작성하는 방법도 있겠지만 코드가 매우 복잡해질 것으로 예상되었고, 이후 설명할 방식에 비하면 획득할 수 있는 최종 점수의 기댓값이 낮을 것 같았다. 따라서 플레이 종료 시점까지의 미래를 전부 계산하여 항상 최적의 선택을 하는 AI 알고리즘을 짜서 구현하기로 했다. (저티어 플레이어를 위한 실력 조절에 대해서는 추후 포스팅 예정)</p><p>요트 다이스 게임을 하며 플레이어가 주사위를 굴린 직후, 마주할 수 있는 경우의 수를 계산해보자.<br /></p><ul><li>카테고리가 총 13개라면, 각 카테고리가 채워졌는지 여부에 따른 경우의 수는 2^13 = <strong>8192가지</strong>이다. (정확히 계산하려면 모든 카테고리가 채워진 상태에는 더 이상 주사위를 굴리지 않으므로 1을 빼야 하지만 편의를 위해 생략했다)<br /><li>주사위를 최대 두 번 리롤할 수 있으므로, 한 턴에 주사위를 굴리는 횟수는 최대 3번이다. 따라서 주사위를 굴리는 횟수로 인한 경우의 수는 <strong>3가지</strong>이다.<br /><li>그리고 6면체 주사위를 5개 굴리므로, 중복 조합으로 계산했을 때 주사위에서 나올 수 있는 경우의 수는 6H5 = <strong>252가지</strong>이다.</ul><p>즉, 8192 x 3 x 252 = <strong>6,193,152가지</strong>의 경우의 수에 대한 모든 최적 행동을 구하는 알고리즘을 짜면, 게임의 어디에서든 구해놓은 최적 행동을 이용해서 플레이가 가능할 것이다. <br /><br /></p><h2 id="어떻게-구현했는가">어떻게 구현했는가</h2><ol><li><strong>모든 가능한 행동을 하나씩 다 수행</strong>해본다.<ul><li>즉, 카테고리 선택을 하거나, 주사위 일부 또는 전부를 리롤한다.</ul><li>그 행동을 취한 후 주사위를 굴렸을 때 나올 수 있는 <strong>모든 주사위의 조합에 대해 시뮬레이션하여, 얻을 수 있는 점수의 기댓값을 계산</strong>한다.<ul><li>카테고리 선택을 한 경우: 다음 턴이 시작되어 주사위를 새로 굴리므로 주사위 눈의 조합 252개 전체에 대해 시뮬레이션한다.<li>리롤하는 경우: 리롤하기로 택한 주사위에 따라 나올 수 있는 모든 경우의 수에 대해 시뮬레이션 한다.</ul><li>위에서 구한 점수 기댓값 중 <strong>가장 높은 기댓값을 갖는 행동</strong>을 선택한다.<ul><li>즉, 점수 기댓값이 가장 높은 상태로 이동하는 행동을 취한다.</ul></ol><p>주사위를 굴릴 때마다 위 작업을 반복하면 항상 최선의 선택을 할 수 있을 것이다.<br /> 그러나 각 행동에서 얻을 수 있는 최고 점수를 알기 위해서는, 해당 시점부터 게임 종료까지 발생할 수 있는 모든 행동과 주사위 경우의 수를 전부 탐색해야 한다. 이 방식을 나이브하게 구현하면, 코드 실행에 상상도 못 할 정도로 오랜 시간이 걸릴 것이다. 따라서 최적화가 필요하다. <br /><br /></p><h2 id="어떻게-최적화했는가">어떻게 최적화했는가</h2><p>위에서 구한 약 6백만 가지의 경우의 수에는 <strong>방향성</strong>이 있다. 게임을 플레이할 때는 항상 카테고리가 점점 많이 채워지는 방향으로 진행하기 때문이다.<br /> 즉, 어떤 상황에서 최적 행동을 구하기 위해 ‘현재 상황보다 카테고리가 적게 채워진 상태’의 기댓값은 알 필요가 없다. 그런 상태는 이미 과거에 지나쳤거나, 현재 상황과는 무관한 상태이기 때문이다.</p><p>하지만 ‘현재 상황보다 카테고리가 많이 채워진 상태’, 즉 <strong>미래에 발생할 수 있는 어떤 상태의 기댓값은 현재의 최적 행동을 구하기 위해 꼭 필요한 정보</strong>다. 게임의 종료에 가까운 상태의 기댓값은, 그보다 종료에 덜 가까운 상태의 최적 행동 계산에 필요하다. 또한 어떤 상태의 기댓값은 여러 번 참조될 수 있다.<br /> 따라서 어떤 상태의 기댓값을 계산하게 되면 그 값을 저장해두고, 나중에 필요할 때는 다시 계산하지 않고 저장해둔 값을 재활용함으로써 수행 시간을 획기적으로 줄일 수 있다. 바로 <strong>다이나믹 프로그래밍</strong>(DP)을 사용하는 것이다. <br /><br /></p><h2 id="주의-사항">주의 사항</h2><ul><li>여기서 보관하는 값은 행동에 대한 기댓값이 아닌, <strong>상태에 대한 기댓값</strong>이다. 어떤 상태에서 행동을 취함으로써 또 다른 상태로 이동하게 된다. 이동할 수 있는 상태들의 기댓값들을 비교하여 어느 상태로 이동할지 결정하는 것이 곧 어떤 행동을 선택할지 결정하는 것과 같다.<li><strong>어떤 상태의 기댓값</strong>이란 그 상태에서 게임을 시작했다고 가정하고, 게임 종료에 도달했을 때까지 얻을 수 있는 점수의 기댓값이라는 의미이다. 그 상태가 되기 이전에 얻은 점수는 포함하지 않는다. <br /><br /></ul><hr /><h1 id="-panchtaih-">• PanchtAI.h •</h1><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
</pre><td class="rouge-code"><pre><span class="cp">#ifndef PANCHT_AI_H
#define PANCHT_AI_H
</span>
<span class="k">enum</span> <span class="n">Category</span> <span class="p">{</span>
    <span class="n">ACES</span><span class="p">,</span> <span class="n">TWOS</span><span class="p">,</span> <span class="n">THREES</span><span class="p">,</span> <span class="n">FOURS</span><span class="p">,</span> <span class="n">FIVES</span><span class="p">,</span> <span class="n">SIXES</span><span class="p">,</span>
    <span class="n">CHOICE</span><span class="p">,</span> <span class="n">THREE_OF_A_KIND</span><span class="p">,</span> <span class="n">FOUR_OF_A_KIND</span><span class="p">,</span> <span class="n">FULL_HOUSE</span><span class="p">,</span>
    <span class="n">SMALL_STRAIGHT</span><span class="p">,</span> <span class="n">LARGE_STRAIGHT</span><span class="p">,</span> <span class="n">YACHT</span><span class="p">,</span>
    <span class="n">NONE</span>
<span class="p">};</span>

<span class="k">struct</span> <span class="nc">DicesInfo</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">dices</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
    <span class="kt">int</span><span class="o">&amp;</span> <span class="k">operator</span><span class="p">[](</span><span class="kt">int</span> <span class="n">idx</span><span class="p">)</span> <span class="p">{</span> <span class="k">return</span> <span class="n">dices</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span> <span class="p">}</span>
<span class="p">};</span>

<span class="k">constexpr</span> <span class="kt">int</span> <span class="n">ANS_6_POW</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">1296</span> <span class="p">};</span>
<span class="k">constexpr</span> <span class="kt">int</span> <span class="n">ANS_6_POW_5</span> <span class="o">=</span> <span class="mi">7776</span><span class="p">;</span>
<span class="k">constexpr</span> <span class="kt">int</span> <span class="n">ANS_2_POW_5</span> <span class="o">=</span> <span class="mi">32</span><span class="p">;</span>
<span class="k">constexpr</span> <span class="kt">int</span> <span class="n">ANS_2_POW_13</span> <span class="o">=</span> <span class="mi">8192</span><span class="p">;</span>

<span class="k">constexpr</span> <span class="kt">int</span> <span class="n">CATEGORY_CNT</span> <span class="o">=</span> <span class="mi">13</span><span class="p">;</span>
<span class="k">constexpr</span> <span class="kt">int</span> <span class="n">DICE_CNT</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
<span class="k">constexpr</span> <span class="kt">int</span> <span class="n">DICE_CASE_CNT</span> <span class="o">=</span> <span class="mi">252</span><span class="p">;</span> <span class="c1">// = 6H5 = 10C5</span>

<span class="k">extern</span> <span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">categoryNames</span><span class="p">[];</span>
<span class="k">extern</span> <span class="kt">int8_t</span> <span class="n">bestAction</span><span class="p">[</span><span class="n">ANS_2_POW_13</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="n">DICE_CASE_CNT</span><span class="p">];</span>

<span class="k">extern</span> <span class="kt">double</span> <span class="n">aiScoreWeight</span><span class="p">;</span>

<span class="k">extern</span> <span class="kt">void</span> <span class="nf">initComb</span><span class="p">();</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="nf">initArrays</span><span class="p">();</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="nf">getEarnedScore</span><span class="p">(</span><span class="n">Category</span> <span class="n">category</span><span class="p">,</span> <span class="n">DicesInfo</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">forAI</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="nf">convertDicesInfoToInt</span><span class="p">(</span><span class="n">DicesInfo</span><span class="o">&amp;</span> <span class="n">diceInfo</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="nf">convertDiceIntToInfo</span><span class="p">(</span><span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="n">DicesInfo</span><span class="o">&amp;</span> <span class="n">dices</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">int</span> <span class="nf">convertActionInfoToInt</span><span class="p">(</span><span class="n">Category</span> <span class="n">category</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rerollMask</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="nf">convertActionIntToInfo</span><span class="p">(</span><span class="kt">int</span> <span class="n">actionInt</span><span class="p">,</span> <span class="n">Category</span><span class="o">&amp;</span> <span class="n">category</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">rerollMask</span><span class="p">);</span>
<span class="k">extern</span> <span class="kt">void</span> <span class="nf">calBestActionAndScore</span><span class="p">(</span><span class="kt">int</span> <span class="n">categoryMask</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rerolledCnt</span><span class="p">,</span> <span class="n">DicesInfo</span> <span class="n">dicesInfo</span><span class="p">);</span>

<span class="cp">#endif
</span></pre></table></code></div></div><p>최적 선택 로직이 필요한 코드에서 공용으로 사용할 헤더 파일을 만들었다. 이 파일에는 카테고리 열거형과 주사위 눈 정보 구조체, 그리고 일부 상수, 배열, 함수 선언이 포함되어 있다. 각 함수의 구현 세부 내용은 뒤에서 소개할 <code class="language-plaintext highlighter-rouge">PanchtAI.cpp</code> 코드 설명에서 다루겠다. <br /><br /></p><hr /><h1 id="-panchtaicpp의-배열들-">• PanchtAI.cpp의 배열들 •</h1><h2 id="combtable">combTable[]</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">static</span> <span class="kt">int</span> <span class="n">combTable</span><span class="p">[</span><span class="mi">20</span><span class="p">][</span><span class="mi">20</span><span class="p">];</span>
</pre></table></code></div></div><p>조합 연산이 필요한 부분에서 빠르게 참조할 수 있도록, 미리 계산한 값을 저장해둔 배열이다. <code class="language-plaintext highlighter-rouge">combTable[n][m]</code>을 참조하면 nCm의 값을 얻을 수 있다. <br /><br /></p><h2 id="bestaction">bestAction[]</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kt">int8_t</span> <span class="n">bestAction</span><span class="p">[</span><span class="n">ANS_2_POW_13</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="n">DICE_CASE_CNT</span><span class="p">];</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">bestAction</code> 배열은 위에서 말한 약 6백만 가지의 <strong>상태 각각에 대한 최적 행동</strong>을 저장하는 3차원 배열이다.<br /> 최적 행동을 하나의 정수로 인코딩하는 방법은 이후 나올 함수 구현 설명에서 자세히 다루겠다.</p><ul><li>첫 번째 인자: 각 카테고리 선택 여부를 정수로 변환한 값 (0~8191)<li>두 번째 인자: 해당 턴에 리롤한 횟수를 나타낸 값 (0~2)<li>세 번째 인자: 주사위 5개의 상태를 하나의 정수로 변환해 나타낸 값 (0~251) <br /><br /></ul><h2 id="bestscore">bestScore[]</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kt">double</span> <span class="n">bestScore</span><span class="p">[</span><span class="n">ANS_2_POW_13</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="n">DICE_CASE_CNT</span><span class="p">];</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">bestScore</code> 배열은 약 6백만 가지의 <strong>상태 각각에서 얻을 수 있는 최대 기댓값</strong>을 저장한다. 각 인자들의 의미는 <code class="language-plaintext highlighter-rouge">bestAction</code> 배열과 동일하다.<br /> 게임 후반으로 갈수록 각 상태의 기댓값 차이가 미미해지므로 소수점 아래 값이 중요해진다. 처음에는 이 값을 <code class="language-plaintext highlighter-rouge">int</code>로 저장했었는데, 이렇게 하면 기댓값의 정수 부분이 동일한 행동들 중 코드상에서 먼저 계산하는 행동을 선택하게 된다. 그 결과, 리롤을 하지 않고 카테고리 선택을 성급하게 해버리는 경향이 있었다. 이 문제는 자료형을 <code class="language-plaintext highlighter-rouge">double</code>로 변경하며 기댓값 손실을 방지하여 해결되었다. <br /><br /></p><h2 id="avgscore">avgScore[]</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kt">double</span> <span class="n">avgScore</span><span class="p">[</span><span class="n">ANS_2_POW_13</span><span class="p">];</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">avgScore</code> 배열은 2^13 = 8192가지의 카테고리 선택 여부에 따라 <strong>턴 시작 시점에서 얻을 수 있는 기댓값</strong>을 저장한다. <br /><br /></p><h2 id="avgscore2">avgScore2[]</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kt">double</span> <span class="n">avgScore2</span><span class="p">[</span><span class="n">ANS_2_POW_13</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="n">DICE_CASE_CNT</span><span class="p">][</span><span class="n">ANS_2_POW_5</span><span class="p">];</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">avgScore2</code> 배열은 약 6백만 가지의 <strong>상태 각각에서 리롤하는 모든 선택지에 대한 기댓값</strong>을 저장한다.</p><ul><li>첫 번째 인자: 각 카테고리 선택 여부를 정수로 변환한 값 (0~8191)<li>두 번째 인자: 해당 턴에 리롤한 횟수를 나타낸 값 (0~2)<li>세 번째 인자: 주사위 5개의 상태를 하나의 정수로 변환해 나타낸 값 (0~251)<li>네 번째 인자: 리롤할 주사위 선택 여부를 하나의 정수로 나타낸 값 (0~31) <br /><br /></ul><hr /><h1 id="-panchtaicpp의-함수들-">• PanchtAI.cpp의 함수들 •</h1><h2 id="initcomb--comb">initComb() &amp; comb()</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">initComb</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">combTable</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">combTable</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">combTable</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">combTable</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">comb</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="p">,</span> <span class="kt">int</span> <span class="n">k</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&gt;</span> <span class="n">n</span> <span class="o">||</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">combTable</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
<span class="p">}</span>
</pre></table></code></div></div><p>처음 프로그램 실행 시 <code class="language-plaintext highlighter-rouge">initComb()</code>를 한 번 호출하여 미리 <code class="language-plaintext highlighter-rouge">combTable</code> 배열을 초기화한다. 이후 어디서든 <code class="language-plaintext highlighter-rouge">comb()</code>를 호출해 조합 연산의 결과를 빠르게 사용할 수 있도록 작성했다. <br /><br /></p><h2 id="initarrays">initArrays()</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">initArrays</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ANS_2_POW_13</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">avgScore</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>

        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">DICE_CASE_CNT</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">bestAction</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
                <span class="n">bestScore</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>

                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">ANS_2_POW_5</span><span class="p">;</span> <span class="n">l</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">avgScore2</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p>위에서 설명한 여러 DP 배열의 모든 원소를 <code class="language-plaintext highlighter-rouge">-1</code>로 초기화하는 함수이다. <code class="language-plaintext highlighter-rouge">initComb()</code>와 마찬가지로 프로그램 처음 실행 시 한 번 호출해야 한다.<br /> 이후, 이 배열들을 참조할 때 값이 <code class="language-plaintext highlighter-rouge">-1</code>이라면 아직 계산되지 않았음을 의미하므로 새로 계산해야 하고, <code class="language-plaintext highlighter-rouge">-1</code>이 아니라면 이미 계산된 것이므로 그대로 재활용한다. <br /><br /></p><h2 id="getearnedscore">getEarnedScore()</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">getEarnedScore</span><span class="p">(</span><span class="n">Category</span> <span class="n">category</span><span class="p">,</span> <span class="n">DicesInfo</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">forAI</span> <span class="o">=</span> <span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ACES</span> <span class="o">&lt;=</span> <span class="n">category</span> <span class="o">&amp;&amp;</span> <span class="n">category</span> <span class="o">&lt;=</span> <span class="n">SIXES</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dicesInfo</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">category</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="n">score</span> <span class="o">+=</span> <span class="n">category</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">forAI</span><span class="p">)</span> <span class="k">return</span> <span class="n">score</span> <span class="o">*</span> <span class="n">aiScoreWeight</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">score</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="kt">int</span> <span class="n">totSum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">totSum</span> <span class="o">+=</span> <span class="n">dicesInfo</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">numFreq</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">numFreq</span><span class="p">[</span><span class="n">dicesInfo</span><span class="p">.</span><span class="n">dices</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">category</span> <span class="o">==</span> <span class="n">CHOICE</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">totSum</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">category</span> <span class="o">==</span> <span class="n">THREE_OF_A_KIND</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">numFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">)</span> <span class="k">return</span> <span class="n">totSum</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">category</span> <span class="o">==</span> <span class="n">FOUR_OF_A_KIND</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">numFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="k">return</span> <span class="n">totSum</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">category</span> <span class="o">==</span> <span class="n">FULL_HOUSE</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">bool</span> <span class="n">hasThree</span> <span class="o">=</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hasTwo</span> <span class="o">=</span> <span class="nb">false</span><span class="p">,</span> <span class="n">hasFive</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">numFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="n">hasThree</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">numFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="n">hasTwo</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">numFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="n">hasFive</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">hasThree</span> <span class="o">&amp;&amp;</span> <span class="n">hasTwo</span> <span class="o">||</span> <span class="n">hasFive</span><span class="p">)</span> <span class="k">return</span> <span class="n">totSum</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">category</span> <span class="o">==</span> <span class="n">SMALL_STRAIGHT</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">bool</span> <span class="n">isSmallStraight</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">numFreq</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">isSmallStraight</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">isSmallStraight</span><span class="p">)</span> <span class="k">return</span> <span class="mi">15</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">category</span> <span class="o">==</span> <span class="n">LARGE_STRAIGHT</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">bool</span> <span class="n">isLargeStraight</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">numFreq</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">isLargeStraight</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">isLargeStraight</span><span class="p">)</span> <span class="k">return</span> <span class="mi">30</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">category</span> <span class="o">==</span> <span class="n">YACHT</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">numFreq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="k">return</span> <span class="mi">50</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>선택한 카테고리와 주사위 눈 정보를 넘기면 <strong>그 카테고리에서 해당 주사위 눈으로 얻을 수 있는 점수</strong>를 반환하는 함수이다. <br /><br /></p><h2 id="convertdicesinfotoint">convertDicesInfoToInt()</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">convertDicesInfoToInt</span><span class="p">(</span><span class="n">DicesInfo</span><span class="o">&amp;</span> <span class="n">dicesInfo</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">freq</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">DICE_CNT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">freq</span><span class="p">[</span><span class="n">dicesInfo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">remain</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">skip_val</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">skip_val</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">;</span> <span class="n">skip_val</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">ways</span> <span class="o">=</span> <span class="n">comb</span><span class="p">(</span><span class="n">remain</span> <span class="o">-</span> <span class="n">skip_val</span> <span class="o">+</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span> <span class="o">-</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>
            <span class="n">idx</span> <span class="o">+=</span> <span class="n">ways</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">remain</span> <span class="o">-=</span> <span class="n">x</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">idx</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>주사위 다섯 개의 눈 정보를 받아 0부터 251 사이의 정수로 매핑</strong>하는 함수이다. 이를 통해 주사위 눈 정보를 배열의 인덱스로 직접 사용할 수 있게 해준다.<br /> 원래 주사위 5개에서 나올 수 있는 경우의 수는 6^5 = 7776가지이지만, 이 게임에서는 주사위 눈의 순서가 중요하지 않다. 순서를 무시하고 오름차순으로 정렬했을 때는 경우의 수가 252가지로 줄어든다. 이 점을 활용해 0~251 범위로 오름차순 매핑하였다. <br /><br /></p><h2 id="convertdiceinttoinfo">convertDiceIntToInfo()</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">convertDiceIntToInfo</span><span class="p">(</span><span class="kt">int</span> <span class="n">idx</span><span class="p">,</span> <span class="n">DicesInfo</span><span class="o">&amp;</span> <span class="n">dices</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">freq</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">0</span> <span class="p">};</span>
    <span class="kt">int</span> <span class="n">remain</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">while</span> <span class="p">(</span><span class="nb">true</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">remain</span> <span class="o">-</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">break</span><span class="p">;</span>

            <span class="kt">int</span> <span class="n">ways</span> <span class="o">=</span> <span class="n">comb</span><span class="p">(</span><span class="n">remain</span> <span class="o">-</span> <span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">ways</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">x</span><span class="o">++</span><span class="p">;</span>
                <span class="k">continue</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">ways</span> <span class="o">&gt;</span> <span class="n">idx</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">freq</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">;</span>
                <span class="n">remain</span> <span class="o">-=</span> <span class="n">x</span><span class="p">;</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="k">else</span> <span class="p">{</span>
                <span class="n">idx</span> <span class="o">-=</span> <span class="n">ways</span><span class="p">;</span>
                <span class="n">x</span><span class="o">++</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">dices</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span> <span class="p">};</span>
    <span class="kt">int</span> <span class="n">pos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">face</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">face</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="p">;</span> <span class="n">face</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">freq</span><span class="p">[</span><span class="n">face</span><span class="p">];</span> <span class="n">count</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">dices</span><span class="p">[</span><span class="n">pos</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">face</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>매핑된 주사위 눈 정수를 받아 다시 5개의 주사위 눈 정보로 변환</strong>하는 함수이다. 항상 오름차순으로 정렬된 주사위 눈 정보를 반환한다. <br /><br /></p><h2 id="convertactioninfotoint">convertActionInfoToInt()</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">convertActionInfoToInt</span><span class="p">(</span><span class="n">Category</span> <span class="n">category</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rerollMask</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">category</span> <span class="o">!=</span> <span class="n">NONE</span><span class="p">)</span> <span class="k">return</span> <span class="n">category</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">12</span> <span class="o">+</span> <span class="n">rerollMask</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>카테고리 정보와 리롤 주사위 정보를 각각 정수로 입력받아, <strong>행동을 하나의 정수로 압축</strong>하여 반환한다. 하나의 행동에는 ‘카테고리 선택’ 또는 ‘리롤’ 중 한 가지만 포함될 수 있으므로, 이 함수를 호출할 때는 무조건 <code class="language-plaintext highlighter-rouge">category</code>를 <code class="language-plaintext highlighter-rouge">NONE</code>으로 하거나 <code class="language-plaintext highlighter-rouge">rerollMask</code>를 <code class="language-plaintext highlighter-rouge">0</code>으로 설정해야 한다.</p><p>반환값은 0~44 범위를 갖는다.</p><ul><li>0~12: 특정 카테고리 선택<li>13~44: 주사위 일부 또는 전체를 리롤 <br /><br /></ul><h2 id="convertactioninttoinfo">convertActionIntToInfo()</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">convertActionIntToInfo</span><span class="p">(</span><span class="kt">int</span> <span class="n">actionInt</span><span class="p">,</span> <span class="n">Category</span><span class="o">&amp;</span> <span class="n">category</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">rerollMask</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">actionInt</span> <span class="o">&lt;=</span> <span class="mi">12</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">category</span> <span class="o">=</span> <span class="p">(</span><span class="n">Category</span><span class="p">)</span><span class="n">actionInt</span><span class="p">;</span>
        <span class="n">rerollMask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">category</span> <span class="o">=</span> <span class="n">NONE</span><span class="p">;</span>
    <span class="n">rerollMask</span> <span class="o">=</span> <span class="n">actionInt</span> <span class="o">-</span> <span class="mi">12</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p><strong>압축된 행동 정수를 다시 카테고리 정보 또는 리롤 주사위 정보로 변환</strong>하는 함수이다. <br /><br /></p><h2 id="getavgscorecategorymask">getAvgScore(categoryMask)</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kt">double</span> <span class="nf">getAvgScore</span><span class="p">(</span><span class="kt">int</span> <span class="n">categoryMask</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">avgScore</span><span class="p">[</span><span class="n">categoryMask</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="n">avgScore</span><span class="p">[</span><span class="n">categoryMask</span><span class="p">];</span>

    <span class="kt">double</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">diceInfoInt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">diceInfoInt</span> <span class="o">&lt;</span> <span class="n">DICE_CASE_CNT</span><span class="p">;</span> <span class="n">diceInfoInt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">DicesInfo</span> <span class="n">dicesInfo</span><span class="p">;</span>
        <span class="n">convertDiceIntToInfo</span><span class="p">(</span><span class="n">diceInfoInt</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">);</span>
        <span class="n">calBestActionAndScore</span><span class="p">(</span><span class="n">categoryMask</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">);</span>
        <span class="n">sum</span> <span class="o">+=</span> <span class="n">bestScore</span><span class="p">[</span><span class="n">categoryMask</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">diceInfoInt</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">avgScore</span><span class="p">[</span><span class="n">categoryMask</span><span class="p">]</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">/</span> <span class="n">DICE_CASE_CNT</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>위에서 언급한 avgScore 배열에 대응하는 DP 함수이다. 주어진 카테고리 선택 여부에서 <strong>턴을 시작한 시점에 얻을 수 있는 기댓값</strong>을 반환하는 함수이다. 이를 위해 가능한 252가지 주사위 결과를 모두 시뮬레이션하고, 각 결과의 최대 기댓값들의 평균을 반환함으로써 원하는 값을 얻는다. <br /><br /></p><h2 id="getavgscorecategorymask-rerolledcnt-dicesinfo-rerollmask">getAvgScore(categoryMask, rerolledCnt, dicesInfo, rerollMask)</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="kt">double</span> <span class="nf">getAvgScore</span><span class="p">(</span><span class="kt">int</span> <span class="n">categoryMask</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rerolledCnt</span><span class="p">,</span> <span class="n">DicesInfo</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rerollMask</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">dicesInfoInt</span> <span class="o">=</span> <span class="n">convertDicesInfoToInt</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">);</span>
    <span class="kt">double</span><span class="o">&amp;</span> <span class="n">crAvgScore</span> <span class="o">=</span> <span class="n">avgScore2</span><span class="p">[</span><span class="n">categoryMask</span><span class="p">][</span><span class="n">rerolledCnt</span><span class="p">][</span><span class="n">dicesInfoInt</span><span class="p">][</span><span class="n">rerollMask</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">crAvgScore</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span> <span class="n">crAvgScore</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">rerollIdx</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span>
    <span class="kt">int</span> <span class="n">rerollCnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">DICE_CNT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">rerollMask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="n">rerollIdx</span><span class="p">[</span><span class="n">rerollCnt</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">rerollCaseCnt</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">rerollCnt</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="n">rerollCaseCnt</span> <span class="o">*=</span> <span class="mi">6</span><span class="p">;</span>

    <span class="kt">double</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">caseInt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">caseInt</span> <span class="o">&lt;</span> <span class="n">rerollCaseCnt</span><span class="p">;</span> <span class="n">caseInt</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">DicesInfo</span> <span class="n">newDices</span> <span class="o">=</span> <span class="n">dicesInfo</span><span class="p">;</span>

        <span class="kt">int</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">caseInt</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">rerollCnt</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="kt">int</span> <span class="n">roll</span> <span class="o">=</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">%</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
            <span class="n">tmp</span> <span class="o">/=</span> <span class="mi">6</span><span class="p">;</span>
            <span class="n">newDices</span><span class="p">[</span><span class="n">rerollIdx</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">roll</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">calBestActionAndScore</span><span class="p">(</span><span class="n">categoryMask</span><span class="p">,</span> <span class="n">rerolledCnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">newDices</span><span class="p">);</span>
        <span class="kt">int</span> <span class="n">newDicesInt</span> <span class="o">=</span> <span class="n">convertDicesInfoToInt</span><span class="p">(</span><span class="n">newDices</span><span class="p">);</span>
        <span class="n">sum</span> <span class="o">+=</span> <span class="n">bestScore</span><span class="p">[</span><span class="n">categoryMask</span><span class="p">][</span><span class="n">rerolledCnt</span> <span class="o">+</span> <span class="mi">1</span><span class="p">][</span><span class="n">newDicesInt</span><span class="p">];</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">crAvgScore</span> <span class="o">=</span> <span class="n">sum</span> <span class="o">/</span> <span class="n">rerollCaseCnt</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>위에서 언급한 <code class="language-plaintext highlighter-rouge">avgScore2</code> 배열에 대응하는 DP 함수이다. 각 카테고리 선택 여부, 리롤 횟수, 주사위 눈 정보, 그리고 리롤할 주사위 정보를 받아서 <strong>해당 리롤을 수행했을 때 얻게 되는 기댓값</strong>을 반환하는 함수이다. 마찬가지로 리롤 후 가능한 주사위의 결과를 모두 시뮬레이션하고, 각 결과의 최대 기댓값들의 평균을 반환함으로써 원하는 값을 얻는다. <br /><br /></p><h2 id="calbestactionandscore">calBestActionAndScore()</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">calBestActionAndScore</span><span class="p">(</span><span class="kt">int</span> <span class="n">categoryMask</span><span class="p">,</span> <span class="kt">int</span> <span class="n">rerolledCnt</span><span class="p">,</span> <span class="n">DicesInfo</span> <span class="n">dicesInfo</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">dicesInfoInt</span> <span class="o">=</span> <span class="n">convertDicesInfoToInt</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">);</span>
    <span class="kt">int8_t</span><span class="o">&amp;</span> <span class="n">crBestAction</span> <span class="o">=</span> <span class="n">bestAction</span><span class="p">[</span><span class="n">categoryMask</span><span class="p">][</span><span class="n">rerolledCnt</span><span class="p">][</span><span class="n">dicesInfoInt</span><span class="p">];</span>
    <span class="kt">double</span><span class="o">&amp;</span> <span class="n">crBestScore</span> <span class="o">=</span> <span class="n">bestScore</span><span class="p">[</span><span class="n">categoryMask</span><span class="p">][</span><span class="n">rerolledCnt</span><span class="p">][</span><span class="n">dicesInfoInt</span><span class="p">];</span>

    <span class="n">sort</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">.</span><span class="n">dices</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">.</span><span class="n">dices</span> <span class="o">+</span> <span class="n">DICE_CNT</span><span class="p">);</span>

    <span class="c1">//이미 계산한/불러온 케이스인 경우 계산 결과 반환</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">crBestAction</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">return</span><span class="p">;</span>

    <span class="kt">int</span> <span class="n">remainCategoryCnt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">CATEGORY_CNT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">categoryMask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">remainCategoryCnt</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//카테고리가 1개 남았고 3번째 굴림인 경우 해당 카테고리 반환</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">remainCategoryCnt</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">&amp;&amp;</span> <span class="n">rerolledCnt</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">Category</span> <span class="n">onlyCategory</span> <span class="o">=</span> <span class="n">NONE</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">CATEGORY_CNT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">categoryMask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
            <span class="n">onlyCategory</span> <span class="o">=</span> <span class="p">(</span><span class="n">Category</span><span class="p">)</span><span class="n">i</span><span class="p">;</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">crBestAction</span> <span class="o">=</span> <span class="n">convertActionInfoToInt</span><span class="p">(</span><span class="n">onlyCategory</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">crBestScore</span> <span class="o">=</span> <span class="n">getEarnedScore</span><span class="p">(</span><span class="n">onlyCategory</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//========== 모든 경우의 수에 대해 최대 기댓값을 얻는 액션 찾기 ==========</span>

    <span class="n">Category</span> <span class="n">bestCategory</span> <span class="o">=</span> <span class="n">NONE</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">bestRerollMask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="kt">double</span> <span class="n">bestAvgScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="c1">//카테고리를 선택하는 경우</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">CATEGORY_CNT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">categoryMask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">continue</span><span class="p">;</span>
        <span class="n">Category</span> <span class="n">crCategory</span> <span class="o">=</span> <span class="p">(</span><span class="n">Category</span><span class="p">)</span><span class="n">i</span><span class="p">;</span>

        <span class="kt">double</span> <span class="n">crAvgScore</span> <span class="o">=</span> <span class="n">getEarnedScore</span><span class="p">(</span><span class="n">crCategory</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="nb">true</span><span class="p">)</span> <span class="o">+</span> <span class="n">getAvgScore</span><span class="p">(</span><span class="n">categoryMask</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">));</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">crAvgScore</span> <span class="o">&gt;</span> <span class="n">bestAvgScore</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">bestAvgScore</span> <span class="o">=</span> <span class="n">crAvgScore</span><span class="p">;</span>
            <span class="n">bestCategory</span> <span class="o">=</span> <span class="n">crCategory</span><span class="p">;</span>
            <span class="n">bestRerollMask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">rerolledCnt</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">crBestAction</span> <span class="o">=</span> <span class="n">convertActionInfoToInt</span><span class="p">(</span><span class="n">bestCategory</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
        <span class="n">crBestScore</span> <span class="o">=</span> <span class="n">bestAvgScore</span><span class="p">;</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//리롤하는 경우</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">rerollMask</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">rerollMask</span> <span class="o">&lt;</span> <span class="n">ANS_2_POW_5</span><span class="p">;</span> <span class="n">rerollMask</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">double</span> <span class="n">crAvgScore</span> <span class="o">=</span> <span class="n">getAvgScore</span><span class="p">(</span><span class="n">categoryMask</span><span class="p">,</span> <span class="n">rerolledCnt</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="n">rerollMask</span><span class="p">);</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">crAvgScore</span> <span class="o">&gt;</span> <span class="n">bestAvgScore</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">bestAvgScore</span> <span class="o">=</span> <span class="n">crAvgScore</span><span class="p">;</span>
            <span class="n">bestCategory</span> <span class="o">=</span> <span class="n">NONE</span><span class="p">;</span>
            <span class="n">bestRerollMask</span> <span class="o">=</span> <span class="n">rerollMask</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">crBestAction</span> <span class="o">=</span> <span class="n">convertActionInfoToInt</span><span class="p">(</span><span class="n">bestCategory</span><span class="p">,</span> <span class="n">bestRerollMask</span><span class="p">);</span>
    <span class="n">crBestScore</span> <span class="o">=</span> <span class="n">bestAvgScore</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>위에서 언급한 <code class="language-plaintext highlighter-rouge">bestAction</code> 배열과 <code class="language-plaintext highlighter-rouge">bestScore</code> 배열에 대응하는 DP 함수이자 가장 중요한 함수이다. 각 카테고리 선택 여부, 리롤 횟수, 주사위 눈 정보를 인자로 받는다. 즉, 주사위를 굴린(또는 리롤한) 직후 상태를 총 3개의 인자로써 나타낸 것이다.</p><p>플레이어가 취할 수 있는 행동은 크게 두 가지가 있다.</p><ol><li>빈 카테고리를 선택한다<li>(리롤 횟수가 2보다 작다면) 주사위 일부 또는 전체를 골라 리롤한다</ol><p>함수는 이 두 종류의 가능한 모든 행동을 시도해 본 뒤, 각각의 행동을 통해 이동하게 될 다음 상태의 기댓값들을 모두 계산 및 비교한다. 그리고 그 중 그 <strong>기댓값이 가장 큰 행동과 그 점수</strong>를 동시에 반환한다. <br /><br /></p><hr /><h1 id="-panchtplayercpp-">• PanchtPlayer.cpp •</h1><h2 id="소스코드">소스코드</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;algorithm&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;fstream&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;stdint.h&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;iomanip&gt;</span><span class="cp">
#include</span> <span class="cpf">&lt;ctime&gt;</span><span class="cp">
#include</span> <span class="cpf">"PanchtAI.h"</span><span class="cp">
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="n">DicesInfo</span> <span class="nf">getRandomDices</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">DicesInfo</span> <span class="n">dicesInfo</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">DICE_CNT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">dicesInfo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">.</span><span class="n">dices</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">.</span><span class="n">dices</span> <span class="o">+</span> <span class="n">DICE_CNT</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">dicesInfo</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">DicesInfo</span> <span class="nf">getRandomRerolledDices</span><span class="p">(</span><span class="n">DicesInfo</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">rerollMask</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">DICE_CNT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">rerollMask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="p">{</span>
            <span class="n">dicesInfo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">rand</span><span class="p">()</span> <span class="o">%</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">sort</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">.</span><span class="n">dices</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">.</span><span class="n">dices</span> <span class="o">+</span> <span class="n">DICE_CNT</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">dicesInfo</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">string</span> <span class="nf">diceInfoString</span><span class="p">(</span><span class="n">DicesInfo</span> <span class="n">dicesInfo</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">string</span> <span class="n">str</span> <span class="o">=</span> <span class="s">""</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">DICE_CNT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">str</span> <span class="o">+=</span> <span class="p">(</span><span class="n">dicesInfo</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="sc">'0'</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">DICE_CNT</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="n">str</span> <span class="o">+=</span> <span class="s">", "</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">str</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">printRerollMask</span><span class="p">(</span><span class="kt">int</span> <span class="n">rerollMask</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">string</span> <span class="n">str</span> <span class="o">=</span> <span class="s">"rerollMask: "</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">DICE_CNT</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">str</span> <span class="o">+=</span> <span class="p">(</span><span class="n">rerollMask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="o">?</span> <span class="sc">'1'</span> <span class="o">:</span> <span class="sc">'0'</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">str</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
<span class="p">}</span>


<span class="kt">bool</span> <span class="nf">selectAction</span><span class="p">(</span><span class="kt">int</span> <span class="n">rerolledCnt</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">score</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">numScore</span><span class="p">,</span> <span class="n">DicesInfo</span><span class="o">&amp;</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">categoryMask</span><span class="p">,</span>
    <span class="n">Category</span><span class="o">&amp;</span> <span class="n">bestCategory</span><span class="p">,</span> <span class="kt">int</span><span class="o">&amp;</span> <span class="n">bestRerollMask</span><span class="p">)</span> <span class="p">{</span>

    <span class="n">calBestActionAndScore</span><span class="p">(</span><span class="n">categoryMask</span><span class="p">,</span> <span class="n">rerolledCnt</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">dicesInfoInt</span> <span class="o">=</span> <span class="n">convertDicesInfoToInt</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">);</span>
    <span class="kt">int</span> <span class="n">bestActionInt</span> <span class="o">=</span> <span class="n">bestAction</span><span class="p">[</span><span class="n">categoryMask</span><span class="p">][</span><span class="n">rerolledCnt</span><span class="p">][</span><span class="n">dicesInfoInt</span><span class="p">];</span>

    <span class="n">convertActionIntToInfo</span><span class="p">(</span><span class="n">bestActionInt</span><span class="p">,</span> <span class="n">bestCategory</span><span class="p">,</span> <span class="n">bestRerollMask</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">bestCategory</span> <span class="o">==</span> <span class="n">NONE</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">printRerollMask</span><span class="p">(</span><span class="n">bestRerollMask</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kt">int</span> <span class="n">crScore</span> <span class="o">=</span> <span class="n">getEarnedScore</span><span class="p">(</span><span class="n">bestCategory</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"선택한 카테고리: "</span> <span class="o">&lt;&lt;</span> <span class="n">categoryNames</span><span class="p">[</span><span class="n">bestCategory</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"획득한 점수: "</span> <span class="o">&lt;&lt;</span> <span class="n">crScore</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span>

    <span class="n">score</span> <span class="o">+=</span> <span class="n">crScore</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">ACES</span> <span class="o">&lt;=</span> <span class="n">bestCategory</span> <span class="o">&amp;&amp;</span> <span class="n">bestCategory</span> <span class="o">&lt;=</span> <span class="n">SIXES</span><span class="p">)</span> <span class="n">numScore</span> <span class="o">+=</span> <span class="n">crScore</span><span class="p">;</span>

    <span class="n">categoryMask</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">bestCategory</span><span class="p">);</span>
    <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">playGame</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">categoryMask</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">numScore</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">turn</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">turn</span> <span class="o">&lt;=</span> <span class="n">CATEGORY_CNT</span><span class="p">;</span> <span class="n">turn</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"&lt;"</span> <span class="o">&lt;&lt;</span> <span class="n">turn</span> <span class="o">&lt;&lt;</span> <span class="s">"번째 턴 시작&gt;"</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>

        <span class="n">Category</span> <span class="n">bestCategory</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">bestRerollMask</span><span class="p">;</span>

        <span class="n">DicesInfo</span> <span class="n">dicesInfo</span> <span class="o">=</span> <span class="n">getRandomDices</span><span class="p">();</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"첫 번째 롤: "</span> <span class="o">&lt;&lt;</span> <span class="n">diceInfoString</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">selectAction</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">numScore</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="n">categoryMask</span><span class="p">,</span> <span class="n">bestCategory</span><span class="p">,</span> <span class="n">bestRerollMask</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>

        <span class="n">dicesInfo</span> <span class="o">=</span> <span class="n">getRandomRerolledDices</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">,</span> <span class="n">bestRerollMask</span><span class="p">);</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"두 번째 롤: "</span> <span class="o">&lt;&lt;</span> <span class="n">diceInfoString</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">selectAction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">numScore</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="n">categoryMask</span><span class="p">,</span> <span class="n">bestCategory</span><span class="p">,</span> <span class="n">bestRerollMask</span><span class="p">))</span> <span class="k">continue</span><span class="p">;</span>

        <span class="n">dicesInfo</span> <span class="o">=</span> <span class="n">getRandomRerolledDices</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">,</span> <span class="n">bestRerollMask</span><span class="p">);</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"세 번째 롤: "</span> <span class="o">&lt;&lt;</span> <span class="n">diceInfoString</span><span class="p">(</span><span class="n">dicesInfo</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
        <span class="n">selectAction</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">numScore</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">,</span> <span class="n">categoryMask</span><span class="p">,</span> <span class="n">bestCategory</span><span class="p">,</span> <span class="n">bestRerollMask</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">numScore</span> <span class="o">&gt;=</span> <span class="mi">63</span><span class="p">)</span> <span class="n">score</span> <span class="o">+=</span> <span class="mi">35</span><span class="p">;</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"최종 점수: "</span> <span class="o">&lt;&lt;</span> <span class="n">score</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n\n</span><span class="s">"</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">score</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">srand</span><span class="p">(</span><span class="n">time</span><span class="p">(</span><span class="nb">NULL</span><span class="p">));</span>
    <span class="n">initComb</span><span class="p">();</span>
    <span class="n">initArrays</span><span class="p">();</span>

    <span class="kt">int</span> <span class="n">crScore</span> <span class="o">=</span> <span class="n">playGame</span><span class="p">();</span>
    <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"최종 점수: "</span> <span class="o">&lt;&lt;</span> <span class="n">crScore</span> <span class="o">&lt;&lt;</span> <span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">;</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>이 코드를 실행하면 요트 다이스 게임 플레이 시뮬레이션을 수행한다. 실제 플레이 방식을 모방하면서, 행동을 선택해야 할 때마다 <code class="language-plaintext highlighter-rouge">calBestActionAndScore()</code> 함수를 호출해서 최적 행동을 결정한다.<br /> 카테고리 선택 여부와 리롤할 주사위는 비트마스킹을 활용해 각각 하나의 정수로 표현했다. <br /><br /></p><h2 id="실행-결과">실행 결과</h2><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
</pre><td class="rouge-code"><pre>&lt;1번째 턴 시작&gt;
첫 번째 롤: 2, 2, 5, 5, 6
rerollMask: 11001
두 번째 롤: 1, 1, 3, 5, 5
rerollMask: 11100
세 번째 롤: 2, 5, 5, 6, 6
선택한 카테고리: Choice
획득한 점수: 24

&lt;2번째 턴 시작&gt;
첫 번째 롤: 1, 1, 1, 2, 4
rerollMask: 00011
두 번째 롤: 1, 1, 1, 1, 3
rerollMask: 00001
세 번째 롤: 1, 1, 1, 1, 3
선택한 카테고리: Aces
획득한 점수: 4

&lt;3번째 턴 시작&gt;
첫 번째 롤: 1, 1, 2, 2, 6
rerollMask: 11001
두 번째 롤: 2, 2, 2, 3, 4
rerollMask: 00011
세 번째 롤: 1, 2, 2, 2, 2
선택한 카테고리: Twos
획득한 점수: 8

&lt;4번째 턴 시작&gt;
첫 번째 롤: 1, 3, 4, 5, 5
rerollMask: 10010
두 번째 롤: 3, 3, 4, 4, 5
rerollMask: 10100
세 번째 롤: 3, 3, 3, 4, 5
선택한 카테고리: Threes
획득한 점수: 9

&lt;5번째 턴 시작&gt;
첫 번째 롤: 1, 2, 4, 5, 5
rerollMask: 11100
두 번째 롤: 1, 3, 5, 5, 5
rerollMask: 11000
세 번째 롤: 4, 5, 5, 5, 5
선택한 카테고리: Fives
획득한 점수: 20

&lt;6번째 턴 시작&gt;
첫 번째 롤: 1, 2, 3, 3, 5
rerollMask: 10100
두 번째 롤: 1, 2, 3, 3, 5
rerollMask: 10100
세 번째 롤: 1, 2, 3, 4, 5
선택한 카테고리: LargeStraight
획득한 점수: 30

&lt;7번째 턴 시작&gt;
첫 번째 롤: 1, 3, 3, 4, 5
rerollMask: 11000
두 번째 롤: 1, 3, 3, 4, 5
rerollMask: 11000
세 번째 롤: 2, 3, 4, 4, 5
선택한 카테고리: SmallStraight
획득한 점수: 15

&lt;8번째 턴 시작&gt;
첫 번째 롤: 2, 3, 5, 5, 5
rerollMask: 11000
두 번째 롤: 2, 5, 5, 5, 5
rerollMask: 10000
세 번째 롤: 5, 5, 5, 5, 5
선택한 카테고리: Yacht
획득한 점수: 50

&lt;9번째 턴 시작&gt;
첫 번째 롤: 2, 2, 3, 3, 5
rerollMask: 11111
두 번째 롤: 1, 2, 4, 5, 6
rerollMask: 11011
세 번째 롤: 2, 2, 3, 4, 6
선택한 카테고리: FullHouse
획득한 점수: 0

&lt;10번째 턴 시작&gt;
첫 번째 롤: 2, 3, 4, 6, 6
rerollMask: 11100
두 번째 롤: 3, 5, 6, 6, 6
rerollMask: 11000
세 번째 롤: 3, 5, 6, 6, 6
선택한 카테고리: Sixes
획득한 점수: 18

&lt;11번째 턴 시작&gt;
첫 번째 롤: 1, 2, 2, 2, 5
rerollMask: 10001
두 번째 롤: 2, 2, 2, 2, 3
rerollMask: 00001
세 번째 롤: 2, 2, 2, 2, 4
선택한 카테고리: FourOfAKind
획득한 점수: 12

&lt;12번째 턴 시작&gt;
첫 번째 롤: 1, 3, 4, 4, 6
rerollMask: 11001
두 번째 롤: 3, 4, 4, 4, 6
rerollMask: 10001
세 번째 롤: 3, 4, 4, 4, 4
선택한 카테고리: Fours
획득한 점수: 16

최종 점수: 241
</pre></table></code></div></div><p>플레이어가 실제로 전략적인 선택을 하는 듯한 모습을 확인했다. 지금까지 짠 코드가 예상대로 동작했음을 알 수 있다.<br /> 테스트로 5000회 실행했을 때의 평균 점수는 <strong>205.695점</strong>으로, 준수한 결과가 나왔다.<br /> (참고: DP로 최적화를 했음에도 불구하고 이 코드를 한 번 실행하는 데에 5시간 40분이 소요되었다.) <br /><br /></p><hr /><h1 id="-가중치-세팅-">• 가중치 세팅 •</h1><p>그러나, 최적 선택 로직에 <strong>보너스 점수 획득</strong>이 반영되지 않았다는 한 가지 문제가 남아 있다. 물론 실제 게임 플레이 시뮬레이션에서 최종 점수를 계산할 때는 보너스 점수를 추가해 주지만, 행동 선택 로직에서는 이 보너스를 무시하고 있기 때문이다.<br /> 즉, 카테고리 중 Aces부터 Sixes까지의 획득 점수의 가치가 실제보다 과소평가되고 있다고 볼 수 있다.</p><p>실제로 보너스를 고려해서 완벽한 최적 선택을 구현할 수도 있겠지만, 그러면 코드가 매우 복잡해지고 실행 시간도 훨씬 길어질 것이다. 따라서 최적 행동을 선택할 때, <strong>Aces부터 Sixes의 획득 점수에 1보다 큰 가중치를 부여</strong>하여 최적 선택의 근사치를 얻는 방식을 시도해 보았다.<br /> 최적의 가중치를 찾기 위해 가중치를 변화시키면서 5천회씩 플레이하여 평균 점수를 구했다.</p><div class="language-plaintext highlighter-rouge"><div class="code-header" text-data="plaintext"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>가중치: 1.0, 평균 점수: 205.695
가중치: 1.5, 평균 점수: 208.052
가중치: 2.0, 평균 점수: 211.364
가중치: 2.5, 평균 점수: 211.856
가중치: 3.0, 평균 점수: 211.476
가중치: 3.5, 평균 점수: 211.819
가중치: 4.0, 평균 점수: 209.800
가중치: 4.5, 평균 점수: 209.331
가중치: 5.0, 평균 점수: 207.742
가중치: 5.5, 평균 점수: 206.187
가중치: 6.0, 평균 점수: 203.849
</pre></table></code></div></div><p>예상대로 가중치가 1부터 일정값에 도달할 때까지는 평균 점수가 높아졌다가, 그 후로는 다시 낮아지는 경향성이 보인다. 가중치 2.5와 3.5에서 평균 점수가 가장 높고, 3.0에서는 살짝 낮아졌는데, 이는 5천 회의 시뮬레이션 실행으로는 이상치의 영향을 받았기 때문이라고 판단된다. 결국 <strong>가중치를 3.0으로 결정</strong>함으로써 로직 구현이 완료되었다.</p><p>(참고: 이 게임은 한 판에서 발생하는 랜덤 요소가 매우 많기 때문에 5천 회 정도의 테스트 횟수는 부족하며, 천만 회 정도는 테스트해야 통계적으로 안정적인 결과를 얻을 수 있다는 사실을 뒤늦게 알았다.) <br /><br /></p><hr /><h1 id="-저장-및-불러오기-">• 저장 및 불러오기 •</h1><h2 id="저장하기">저장하기</h2><p>매번 플레이할 때마다 5시간 40분씩 코드를 돌릴 수는 없다. 따라서 <code class="language-plaintext highlighter-rouge">bestAction</code> 배열의 결괏값들을 미리 계산해서 저장해 둔 뒤, 이를 불러와서 사용하기로 했다.</p><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre><td class="rouge-code"><pre><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">initComb</span><span class="p">();</span>
    <span class="n">initArrays</span><span class="p">();</span>

    <span class="n">aiScoreWeight</span> <span class="o">=</span> <span class="mf">3.0f</span><span class="p">;</span>

    <span class="n">ofstream</span> <span class="n">outFile</span><span class="p">(</span><span class="s">"bestAction.bin"</span><span class="p">,</span> <span class="n">ios</span><span class="o">::</span><span class="n">binary</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">outFile</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"bestAction.bin 파일 오픈 실패</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"bestAction.bin 파일 오픈 성공</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

    <span class="k">static</span> <span class="kt">int8_t</span> <span class="n">data</span><span class="p">[</span><span class="n">ANS_2_POW_13</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">DICE_CASE_CNT</span><span class="p">];</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">ANS_2_POW_13</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">DICE_CASE_CNT</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">DicesInfo</span> <span class="n">dicesInfo</span><span class="p">;</span>
                <span class="n">convertDiceIntToInfo</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">);</span>
                <span class="n">calBestActionAndScore</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">dicesInfo</span><span class="p">);</span>

                <span class="kt">int64_t</span> <span class="n">bestActionInt</span> <span class="o">=</span> <span class="n">bestAction</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>

                <span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">DICE_CASE_CNT</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">DICE_CASE_CNT</span> <span class="o">+</span> <span class="n">k</span><span class="p">;</span>
                <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">bestActionInt</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">//printf("진행률: %.2f%%\n", (i + 1) / (float)ANS_2_POW_13 * 100);</span>
        <span class="n">printCategoryMask</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>

        <span class="kt">time_t</span> <span class="n">t</span> <span class="o">=</span> <span class="n">time</span><span class="p">(</span><span class="nb">nullptr</span><span class="p">);</span>
        <span class="n">tm</span><span class="o">*</span> <span class="n">now</span> <span class="o">=</span> <span class="n">localtime</span><span class="p">(</span><span class="o">&amp;</span><span class="n">t</span><span class="p">);</span>
        <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">put_time</span><span class="p">(</span><span class="n">now</span><span class="p">,</span> <span class="s">"  %Y/%m/%d %H:%M:%S"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="sc">'\n'</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">outFile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="k">const</span> <span class="kt">char</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">));</span>
    <span class="n">outFile</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>3차원 배열인 <code class="language-plaintext highlighter-rouge">bestAction</code>을 펼쳐 1차원 배열로 만든 뒤 바이너리 파일에 저장했다. 이 과정을 수행하는 데에도 마찬가지로 5시간 40분이 소요되었다. <br /><br /></p><h2 id="불러오기">불러오기</h2><div class="language-cpp highlighter-rouge"><div class="code-header" text-data="cpp"><button data-original-title="Copied!"><i class="far fa-clone"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kt">void</span> <span class="nf">loadBestActionData</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">ifstream</span> <span class="n">inFile</span><span class="p">(</span><span class="s">"bestAction.bin"</span><span class="p">,</span> <span class="n">ios</span><span class="o">::</span><span class="n">binary</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">inFile</span><span class="p">.</span><span class="n">is_open</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"bestAction.bin 파일 오픈 실패</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"bestAction.bin 파일 오픈 성공</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>

    <span class="k">static</span> <span class="kt">int8_t</span> <span class="n">data</span><span class="p">[</span><span class="n">ANS_2_POW_13</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">DICE_CASE_CNT</span><span class="p">];</span>

    <span class="n">inFile</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">*&gt;</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">data</span><span class="p">));</span>
    <span class="n">inFile</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">ANS_2_POW_13</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">k</span> <span class="o">&lt;</span> <span class="n">DICE_CASE_CNT</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
                <span class="kt">int</span> <span class="n">idx</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">DICE_CASE_CNT</span><span class="p">)</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">DICE_CASE_CNT</span> <span class="o">+</span> <span class="n">k</span><span class="p">;</span>
                <span class="n">bestAction</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">];</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"데이터 불러오기 완료</span><span class="se">\n\n</span><span class="s">"</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>저장된 바이너리 파일을 다시 읽어 1차원 배열에 불러온 후, 이를 3차원 배열에 재배치했다. 이제 프로그램이 처음 실행될 때 <code class="language-plaintext highlighter-rouge">loadBestActionData()</code>를 한 번 호출하면, <code class="language-plaintext highlighter-rouge">bestAction</code> 배열의 모든 원소가 -1이 아닌 유효 상태가 된다. 그 결과, <code class="language-plaintext highlighter-rouge">calBestActionAndScore()</code>를 호출했을 때 원하는 값을 즉시 얻을 수 있다. <br /><br /></p><hr /><h1 id="-후기-">• 후기 •</h1><p>보너스를 완벽히 고려한 로직이 아닌 점은 아쉽지만, 200점대로 꽤 준수한 평균 점수를 내는 로직 구현에 성공한 것에 만족한다. 이 AI를 이용해서 뽑아낸 각종 통계를 그래프로 시각화한 자료를 추후 포스팅하겠다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/development-log/'>Development Log</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/pancht/" class="post-tag no-text-decoration" >Pancht</a> <a href="/tags/algorithm/" class="post-tag no-text-decoration" >Algorithm</a> <a href="/tags/dynamic-programming/" class="post-tag no-text-decoration" >Dynamic Programming</a> <a href="/tags/bitmasking/" class="post-tag no-text-decoration" >Bitmasking</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[Pancht] 요트 다이스 최적 선택 알고리즘을 구현한 방법 - Seohyun's DEVlog&url=https://seoh136199.github.io/posts/yacht-dice-optimal-selection-algorithm/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[Pancht] 요트 다이스 최적 선택 알고리즘을 구현한 방법 - Seohyun's DEVlog&u=https://seoh136199.github.io/posts/yacht-dice-optimal-selection-algorithm/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=[Pancht] 요트 다이스 최적 선택 알고리즘을 구현한 방법 - Seohyun's DEVlog&url=https://seoh136199.github.io/posts/yacht-dice-optimal-selection-algorithm/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/yacht-dice-ai-play-statistics/">[Pancht] 요트 다이스 AI 플레이 통계 및 분석</a><li><a href="/posts/yacht-dice-optimal-selection-algorithm/">[Pancht] 요트 다이스 최적 선택 알고리즘을 구현한 방법</a><li><a href="/posts/spready-optical-illusion-gimmick/">[Spready] 착시 연결 기믹을 구현한 방법</a><li><a href="/posts/cpp-lvalue-rvalue/">[C++] lvalue와 rvalue</a><li><a href="/posts/boj-4781/">[백준 4781번] 사탕 가게 [C++]</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a> <a class="post-tag" href="/tags/data-structure/">Data structure</a> <a class="post-tag" href="/tags/graph/">Graph</a> <a class="post-tag" href="/tags/segment-tree/">Segment tree</a> <a class="post-tag" href="/tags/dfs/">DFS</a> <a class="post-tag" href="/tags/dynamic-programming/">Dynamic Programming</a> <a class="post-tag" href="/tags/minimum-spanning-tree/">Minimum Spanning Tree</a> <a class="post-tag" href="/tags/pancht/">Pancht</a> <a class="post-tag" href="/tags/sort/">Sort</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/boj-4781/"><div class="card-body"> <span class="timeago small" >Aug 26, 2022<i class="unloaded">2022-08-26T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[백준 4781번] 사탕 가게 [C++]</h3><div class="text-muted small"><p> 4781번: 사탕 가게 문제 링크: 4781번: 사탕 가게 개요 각 테스트케이스마다 사탕 n개의 칼로리와 가격이 주어졌을 때, m만큼의 돈으로 얻을 수 있는 최대 칼로리를 출력하는 문제이다. 0/1 배낭 문제의 형태를 띠고 있지만 각 사탕을 무제한으로 구매할 수 있고, 가격이 정수가 아니라는 점을 고려해야 한다. 풀이 n과 m 입력받...</p></div></div></a></div><div class="card"> <a href="/posts/boj-14621/"><div class="card-body"> <span class="timeago small" >Feb 19, 2022<i class="unloaded">2022-02-19T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[백준 14621번] 나만 안되는 연애 [C++]</h3><div class="text-muted small"><p> 14621번: 나만 안되는 연애 문제 링크: 14621번: 나만 안되는 연애 개요 주어진 그래프에서 노드들을 연결하는 최단 거리 트리의 총 거리를 구하는 문제이다. 최소 스패닝 트리 알고리즘 중 크루스칼 알고리즘을 이용해 풀이하겠다. 최소 스패닝 트리에 대해 [알고리즘] 최소 신장 트리(MST, Minimum Spanning Tree)란 포스...</p></div></div></a></div><div class="card"> <a href="/posts/boj-2696/"><div class="card-body"> <span class="timeago small" >Feb 27, 2022<i class="unloaded">2022-02-27T00:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[백준 2696번] 중앙값 구하기 [C++]</h3><div class="text-muted small"><p> 2696번: 중앙값 구하기 문제 링크: 2696번: 중앙값 구하기 개요 문제가 시킨 일인 수열이 주어지면 홀수 번째 수를 읽을 때마다 중앙값을 출력하는 작업만 착실하게 수행하면 되는 문제이다. 하지만 매번 수열을 정렬하고 중간 인덱스 값을 출력하는 방식으로는 시간초과를 피할 수 없다. 따라서 우선순위 큐를 두 개 이용해서 풀이할 것이다. ma...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/spready-optical-illusion-gimmick/" class="btn btn-outline-primary" prompt="Older"><p>[Spready] 착시 연결 기믹을 구현한 방법</p></a> <a href="/posts/yacht-dice-ai-play-statistics/" class="btn btn-outline-primary" prompt="Newer"><p>[Pancht] 요트 다이스 AI 플레이 통계 및 분석</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/fried_ctex">Seohyun Yang</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/baekjoon/">Baekjoon</a> <a class="post-tag" href="/tags/data-structure/">Data structure</a> <a class="post-tag" href="/tags/graph/">Graph</a> <a class="post-tag" href="/tags/segment-tree/">Segment tree</a> <a class="post-tag" href="/tags/dfs/">DFS</a> <a class="post-tag" href="/tags/dynamic-programming/">Dynamic Programming</a> <a class="post-tag" href="/tags/minimum-spanning-tree/">Minimum Spanning Tree</a> <a class="post-tag" href="/tags/pancht/">Pancht</a> <a class="post-tag" href="/tags/sort/">Sort</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://seoh136199.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-VTZLYLE721"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-VTZLYLE721'); }); </script>
